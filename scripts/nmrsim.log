
	****************************************
	***                                  ***
	***       titrationSimulator         ***
	***                                  ***
	****************************************
	***      powered by GNU Octave       ***
	****************************************

	++++++++++++++++++++++++++++++++++++++++
	++         DO THE PEAKS MOVE?         ++
	++++++++++++++++++++++++++++++++++++++++
	++ (c)2023-v14 HvI Utrecht University ++
	++++++++++++++++++++++++++++++++++++++++


Welcome to the NMR titration simulator.

Whenever you see this symbol: <> press return/enter to continue!
For windows users: you sometimes need to press twice ...

Whenever you see this symbol: :)] you have to enter a command.
Which command will be clear later on.

Good luck!

<>
	**** NMR titration simulator ****

You're about to do an in silico NMR titration experiment
to investigate a protein-ligand interaction.

You will get your own protein and your own ligand to investigate.
The ligand is either a small molecule or another protein.

Your goal is to determine the binding interface
and the dissociation constant.

This simulator mimics the important steps
in sample preparation and data acquisition.

You will be guided step-by-step through the experiment.
If something is unclear, ask your instructor.

There are 12 multiple choice questions along the way.
These will be automatically evaluated and scored.

<>

OK, time to start. Enjoy!

<>
warning: suggest parenthesis around assignment used as truth value near line 157, column 19 in file '\\Mac\Home\ONDERWIJS\1-UTRECHT\0-COURSES\BSc-BMSB\COMPUTER-PRACTICALS\CP2\dev\nmrSim\scripts\initialiseSystem.m'
warning: called from
    ini at line 208 column 9

warning: suggest parenthesis around assignment used as truth value near line 153, column 16 in file '\\Mac\Home\ONDERWIJS\1-UTRECHT\0-COURSES\BSc-BMSB\COMPUTER-PRACTICALS\CP2\dev\nmrSim\scripts\initialiseSystem.m'
warning: called from
    ini at line 208 column 9

warning: suggest parenthesis around assignment used as truth value near line 171, column 20 in file '\\Mac\Home\ONDERWIJS\1-UTRECHT\0-COURSES\BSc-BMSB\COMPUTER-PRACTICALS\CP2\dev\nmrSim\scripts\initialiseSystem.m'
warning: called from
    ini at line 208 column 9


***      1. Your protein and ligand       ***

The program will now ask you a few simple questions
in order to select a system for you.
Don't worry about typos or mistakes, it should work anyways.

<>

What is your first name? sjhfkjhdlkF

What is your favorite food? afsqFWEQ2

Please enter your birthday (dd/mm/yyyy): 18763170702

Please enter an inspiring sentence: JabnfOQwpojfw;nv

The computer is now processing your input 
to derive the system of your study....

You will perform a titration of:

	viral factor SJHFKJHDLKF8 ( 14.0 kDa) with
	protein FSQFWQ08 ( 6.6 kDa)

The amino acid squence of SJHFKJHDLKF8 is ANFQWFWNV
<>

Preliminary experiments have shown that the
dissociation constant KD is in the high micromolar range

By doing an NMR titration experiment you will determine
the binding interface and the binding constant of this interaction.

In other words, the question is: Do the peaks move?

<>

Type "makeSample" (without the quotes) at the command prompt to continue.

:)] makeSample

***      2. Your NMR sample      ***

OK, now you need to prepare an NMR sample of your protein SJHFKJHDLKF8 (14.0 kDa),
and a stock solution of your ligand FSQFWQ08 (6.6 kDa).
The goal is to follow the peaks of the protein upon titrating in the ligand.

<>


QUESTION 1.
What labeling strategy is best to use? Also consider costs.
    A. The ligand should be 15N-labeled, the protein unlabeled.
    B. The ligand should be unlabeled, the protein 15N-labeled.
    C. The ligand should be unlabeled, the protein 13C-labeled.
    D. The ligand should be 13C-labeled, the protein 15N-labeled.

Enter your answer: a

Ah too bad...Second guess?? 

Your answer should be A, B, C or D.

Enter your answer again: 

Sorry that's still not correct...

<>

EXPLANATION:
As we want to follow the peaks of the protein, it should be isotope labeled.
Cheapest, most practical option is to leave the ligand unlabeled.
The protein is best labeled with 15N, as the backbone amide chemical shifts
are very sensitive to binding events, more so than 13C chemical shifts.
So B is the right answer.

<>

NEXT:
Now you need to define the protein concentration of your sample.
This is typically 0.1 to 1 mM.

Also, you need to define the concentration of your ligand stock solution.
Since you add the ligand in steps to your NMR sample, 
this stock solution should be as concentrated as possible to reduce dilution effects.
For protein ligands, this is typically limited by their solubility,
luckily yours can be concentrated to 10 mM.

<>

Next enter your protein and ligand concentration in units of mM.

Enter your protein concentration (mM): 1
Enter your ligand stock concentration (mM): 10


OK, your sample is ready.

You have a 500 microliter NMR sample of SJHFKJHDLKF8 (14.0 kDa) at 1.000 mM
You will use a stock solution of FSQFWQ08 (6.6 kDa) at 10.000 mM

Walking to the NMR ....
Putting the sample in the magnet ....
Setting up some stuff ....
Ready to proceed!

<>

You now first need to calibrate the 1H 90 degree pulse for your sample.
First load the parameters of the calibration experiment by typing:

rpar("popt")

at the command prompt (with the quotes surrounding popt) and hit return.
(If you get an error saying popt is undefined, you forgot the quotes!)

:)] graphics_toolkit
ans = qt
:)] rpar("popt")

***      3. Pulse calibration      ***

Loading 1H 90 degree pulse calibration experiment ...
Loaded!

<>

Calibration of the 90 degree pulse is crucial to make sure your experiments work well,
meaning that you get maximum signal and minimal artifacts.

In this experiment you do a series of 1Ds each with a different value for 
the duration of the 1H pulse.

In these spectra you will see only one 1H signal: the water,
as it is the most intense 1H signal.

<>

The goal is that you determine at what duration of the pulse (called p1)
you get a 90 degree rotation of the magnetization.

The 1H 90 degree pulse length varies usually between 7 and 12 microseconds, 
depending on the saltiness of your sample buffer.

<>

Let's do the first try of the calibration experiment together.

<>

To do the calibration:
	 - type "zg" at the prompt
	 - you are asked for a starting value for the pulse length duration,
	   an increment value and a total number of experiments
	 - you examine the result

:)] zg

***      3. Pulse calibration      ***

Just hit enter at the questions below to use the default values
for the calibration setup.

Enter the starting value (in microsec, default is 0): 
Enter the increment value (in microsec, default is 2): 
Enter the number of experiments (default is 21): 

Recording 21 experiments with pulse length varying between 0.0 and 40.0 microseconds...
The data is automatically Fourier Transformed, processed to spectra, and plotted.

	p1  0.0  2.0  4.0  6.0  8.0  10.0  12.0  14.0  16.0  18.0  20.0  22.0  24.0  26.0  28.0  30.0  32.0  34.0  36.0  38.0  40.0 

You see here all spectra plotted straight after each other.
The first spectrum is recorded with p1 is 0.00 microseconds.
The second spectrum is recorded with p1 is 2.00 microseconds.
The third with 4.00 microseconds, etc.
Note that there is no signal in the first spectrum, since p1 is zero
To identify the zero-crossing, find a spectrum close to it, then count 
to find the corresponding p1 value, using the information above.
Note that you cannot use the mouse the identify the spectrum number.

<>

<>


QUESTION 2.
Examine the pulse calibration plot. When do you see no signal?
    A. If you don't apply a pulse
    B. If the magnetization is along the z-axis
    C. If you give a 180-degree pulse
    D. All of the above.

Enter your answer: q

Your answer should be A, B, C or D.

Enter your answer again: q


That was still something else.

No unfortunately...give it another thought... 

Your answer should be A, B, C or D.

Enter your answer again: 

Sorry that's still not correct...

<>

EXPLANATION:
In equilibrium the magnetization is along the magnetic field (the z-axis) and not detectable.
There will only be signal if the magnetization has been rotated to have a component in the xy-plane.
Thus, there will be no signal at 180, 360, 540 degrees, etc (magnetization along + or -z)

<>

NEXT:
As it is easier to check for zero of a sinoid signal than a maximum,
your task is to identify the pulse length value at which you get a zero-crossing
corresponding to a 180 or 360 degree rotation of the magnetization.

Run this experiment again with adjusted range of pulse lengths to zoom in on the zero-crossing.
Type "zg" to run it again


To continue the calibration, type "zg" the command prompt
to adapt the range and number of experiments

:)] p1=trup
p1 = 8.5700
:)] rpar("HSQC")

Wait. Let me first double check your 90-degree pulse length ...

<>


Alright. You did a good job at the calibration!
You found 8.57 us for the 90-degree pulse length,
somehow the computer knows it is actually 8.57 us.
You get 10 points extra!

<>

***      4. Protein HSQC      ***

Loading experimental setup for {1H-15N}-HSQC experiment ...
Loaded! Now setup the acquisition parameters by typing "eda" at the command prompt


<>

:)] 
:)] eda

***      4. Protein HSQC      ***



QUESTION 3.
The HSQC experiment is a two dimensional experiment
that shows a signal for all NH groups in a protein.

Suppose you have a NH2 group in the protein:
two protons connected to the same nitrogen.

Which statement is true?
    A. There will be two peaks on a horizontal line
    B. There will be one peak in the HSQC spectrum: at the average H and N chemical shift
    C. There will be one peak in the HSQC spectrum: only one of two H's will give a signal
    D. There will be no peak in the HSQC

Enter your answer: a

Alright! Another 10 gets you 20 points...

<>

EXPLANATION:
A. is the correct answer. NH2 groups are present in asparagine and glutamine side chains.
The two protons have different chemical shifts.
Both will give a peak at the same 15N chemical shift
These sidechains are thus easily recognized as two signals on a horizontal line.
In this experiment only the backbone NH will show up as signals.

<>

***      4. Protein HSQC      ***


Now enter the acquisition times:


Hit enter to use default values

Enter the 1H acquisition time (in sec, default 0.08): 
Enter the 15N acquisition time (in sec, default 0.04): 
Enter the number of scans (ns) (8, 16, 24, .., default 8): 

Everything is setup!

	The number of scans for the 2D HSQC is 8.
	The 1H 90-degree pulse (p1) is set to 8.57 microseconds.
	The 15N 90-degree pulse (p21) is set to default value of 30.50 microseconds.
	The acquisition times are set to 80 ms for 1H and 40 ms for 15N.

Now start the experiment by typing "zg" at the command prompt

:)] 
:)] zg

***      4. Protein HSQC      ***

Starting HSQC experiment, takes ~1 min depending on
your number of a scans and 1H/15N acquisition times....
Note that in real life such experiment would take ~10min up to 1hr.

Wait, initializing experiment ...
9 8 7 6 5 4 3 2 1 

Starting acquisition ...

The plot shows the FID for each experiment needed to make the 2D spectrum (2nd counter)
 and summed for each scan (first counter)

==> Do not change to another plot window until acquisition is finished.<==


Acquisition finished.

Showing all recorded FIDs



Let's take a closer look at how the plotted FIDs are transformed to a 2D spectrum.

<>

Right now all FIDs are plotted after each other.
Zoom in on the plot to see the individual FIDs.
Use the zoom (+) button to activate zoom mode and drag a rectangle to zoom in
Click the button with a 1 inside the magnifying glass to go back to the full view.

<>


Now let's zoom in on the very first FID.
This shows you the free induction decay in the 1H dimension.
Just as the FID of a 1D 1H spectrum.

If you do a FT of this FID you get a 1H spectrum.

<>


A similar thing is true for say the 11th FID that was recorded.

<>

Here you see the FID

And again if you do a FT of this FID you get a 1H spectrum.

<>

You can see that the intensities of the peaks are now different.
Some peaks are negative and some are positive.

	****************************************
	***                                  ***
	***       titrationSimulator         ***
	***                                  ***
	****************************************
	***      powered by GNU Octave       ***
	****************************************

	++++++++++++++++++++++++++++++++++++++++
	++         DO THE PEAKS MOVE?         ++
	++++++++++++++++++++++++++++++++++++++++
	++ (c)2023-v14 HvI Utrecht University ++
	++++++++++++++++++++++++++++++++++++++++


Loading previous titration system...
Done!

Type "makeSample" (without the quotes) at the command prompt to continue.

:)] makeSample

***      2. Your NMR sample      ***

OK, now you need to prepare an NMR sample of your protein SJHFKJHDLKF8 (14.0 kDa),
and a stock solution of your ligand FSQFWQ08 (6.6 kDa).
The goal is to follow the peaks of the protein upon titrating in the ligand.

<>


QUESTION 1.
What labeling strategy is best to use? Also consider costs.
    A. The ligand should be 15N-labeled, the protein unlabeled.
    B. The ligand should be unlabeled, the protein 15N-labeled.
    C. The ligand should be unlabeled, the protein 13C-labeled.
    D. The ligand should be 13C-labeled, the protein 15N-labeled.

Enter your answer: a

Ah too bad...Second guess?? 

Your answer should be A, B, C or D.

Enter your answer again: 

Sorry that's still not correct...

<>

EXPLANATION:
As we want to follow the peaks of the protein, it should be isotope labeled.
Cheapest, most practical option is to leave the ligand unlabeled.
The protein is best labeled with 15N, as the backbone amide chemical shifts
are very sensitive to binding events, more so than 13C chemical shifts.
So B is the right answer.

<>

NEXT:
Now you need to define the protein concentration of your sample.
This is typically 0.1 to 1 mM.

Also, you need to define the concentration of your ligand stock solution.
Since you add the ligand in steps to your NMR sample, 
this stock solution should be as concentrated as possible to reduce dilution effects.
For protein ligands, this is typically limited by their solubility,
luckily yours can be concentrated to 10 mM.

<>

Next enter your protein and ligand concentration in units of mM.

Enter your protein concentration (mM): 
Enter your ligand stock concentration (mM): 

Please enter a positive number without units for the concentration

Enter your protein concentration (mM): 1
Enter your ligand stock concentration (mM): 10


OK, your sample is ready.

You have a 500 microliter NMR sample of SJHFKJHDLKF8 (14.0 kDa) at 1.000 mM
You will use a stock solution of FSQFWQ08 (6.6 kDa) at 10.000 mM

Walking to the NMR ....
Putting the sample in the magnet ....
Setting up some stuff ....
Ready to proceed!

<>

You now first need to calibrate the 1H 90 degree pulse for your sample.
First load the parameters of the calibration experiment by typing:

rpar("popt")

at the command prompt (with the quotes surrounding popt) and hit return.
(If you get an error saying popt is undefined, you forgot the quotes!)

:)] rpar("popt")

***      3. Pulse calibration      ***

Loading 1H 90 degree pulse calibration experiment ...
Loaded!

<>

Calibration of the 90 degree pulse is crucial to make sure your experiments work well,
meaning that you get maximum signal and minimal artifacts.

In this experiment you do a series of 1Ds each with a different value for 
the duration of the 1H pulse.

In these spectra you will see only one 1H signal: the water,
as it is the most intense 1H signal.

<>

The goal is that you determine at what duration of the pulse (called p1)
you get a 90 degree rotation of the magnetization.

The 1H 90 degree pulse length varies usually between 7 and 12 microseconds, 
depending on the saltiness of your sample buffer.

<>

Let's do the first try of the calibration experiment together.

<>

To do the calibration:
	 - type "zg" at the prompt
	 - you are asked for a starting value for the pulse length duration,
	   an increment value and a total number of experiments
	 - you examine the result

:)] zg

***      3. Pulse calibration      ***

Just hit enter at the questions below to use the default values
for the calibration setup.

Enter the starting value (in microsec, default is 0): 
Enter the increment value (in microsec, default is 2): 
Enter the number of experiments (default is 21): 

Recording 21 experiments with pulse length varying between 0.0 and 40.0 microseconds...
The data is automatically Fourier Transformed, processed to spectra, and plotted.

	p1  0.0  2.0  4.0  6.0  8.0  10.0  12.0  14.0  16.0  18.0  20.0  22.0  24.0  26.0  28.0  30.0  32.0  34.0  36.0  38.0  40.0 

You see here all spectra plotted straight after each other.
The first spectrum is recorded with p1 is 0.00 microseconds.
The second spectrum is recorded with p1 is 2.00 microseconds.
The third with 4.00 microseconds, etc.
Note that there is no signal in the first spectrum, since p1 is zero
To identify the zero-crossing, find a spectrum close to it, then count 
to find the corresponding p1 value, using the information above.
Note that you cannot use the mouse the identify the spectrum number.

<>

<>


QUESTION 2.
Examine the pulse calibration plot. When do you see no signal?
    A. If you don't apply a pulse
    B. If the magnetization is along the z-axis
    C. If you give a 180-degree pulse
    D. All of the above.

Enter your answer: a

Ah too bad...Second guess?? 

Your answer should be A, B, C or D.

Enter your answer again: 

Sorry that's still not correct...

<>

EXPLANATION:
In equilibrium the magnetization is along the magnetic field (the z-axis) and not detectable.
There will only be signal if the magnetization has been rotated to have a component in the xy-plane.
Thus, there will be no signal at 180, 360, 540 degrees, etc (magnetization along + or -z)

<>

NEXT:
As it is easier to check for zero of a sinoid signal than a maximum,
your task is to identify the pulse length value at which you get a zero-crossing
corresponding to a 180 or 360 degree rotation of the magnetization.

Run this experiment again with adjusted range of pulse lengths to zoom in on the zero-crossing.
Type "zg" to run it again


To continue the calibration, type "zg" the command prompt
to adapt the range and number of experiments

:)] p1=trup
p1 = 7.6901
:)] rpar("HSQC")

Wait. Let me first double check your 90-degree pulse length ...

<>


Alright. You did a good job at the calibration!
You found 7.69 us for the 90-degree pulse length,
somehow the computer knows it is actually 7.69 us.
You get 10 points extra!

<>

***      4. Protein HSQC      ***

Loading experimental setup for {1H-15N}-HSQC experiment ...
Loaded! Now setup the acquisition parameters by typing "eda" at the command prompt


<>e

:)] eda

***      4. Protein HSQC      ***



QUESTION 3.
The HSQC experiment is a two dimensional experiment
that shows a signal for all NH groups in a protein.

Suppose you have a NH2 group in the protein:
two protons connected to the same nitrogen.

Which statement is true?
    A. There will be two peaks on a horizontal line
    B. There will be one peak in the HSQC spectrum: at the average H and N chemical shift
    C. There will be one peak in the HSQC spectrum: only one of two H's will give a signal
    D. There will be no peak in the HSQC

Enter your answer: 

Your answer should be A, B, C or D.

Enter your answer again: 


No, that's is not right...reconsider? 

Your answer should be A, B, C or D.

Enter your answer again: 

Sorry that's still not correct...

<>

EXPLANATION:
A. is the correct answer. NH2 groups are present in asparagine and glutamine side chains.
The two protons have different chemical shifts.
Both will give a peak at the same 15N chemical shift
These sidechains are thus easily recognized as two signals on a horizontal line.
In this experiment only the backbone NH will show up as signals.

<>

***      4. Protein HSQC      ***


Now enter the acquisition times:


Hit enter to use default values

Enter the 1H acquisition time (in sec, default 0.08): 
Enter the 15N acquisition time (in sec, default 0.04): 
Enter the number of scans (ns) (8, 16, 24, .., default 8): 

Everything is setup!